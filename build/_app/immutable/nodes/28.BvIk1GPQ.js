const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/C9UhFrXA.js","../chunks/CSpmTaba.js","../chunks/Dmpml9mb.js","../chunks/C6etf3KI.js"])))=>i.map(i=>d[i]);
import{_ as ne}from"../chunks/CmsKOCeN.js";import{S as _t,i as ht,s as pt,d as i,t as Be,a as Ue,c as vt,b as E,I as bt,B as V,e as Ce,D as P,f as Me,o as kt,W as tt,n as me,g as d,h as _,j as J,k as h,G as gt,M as xt,A as X,v as o,H as yt,F as De,q as g,J as It,C as z,K as Et,E as F,z as wt,L as Ve,r as Tt}from"../chunks/C6etf3KI.js";import{e as Pe,u as Ct,d as Dt}from"../chunks/SWtz04H7.js";import"../chunks/IHki7fMi.js";import{p as Vt}from"../chunks/LovyogfJ.js";import{g as Te}from"../chunks/oVNpCzuw.js";import{u as Pt}from"../chunks/C9UhFrXA.js";import{a as fe,p as lt}from"../chunks/Da4qeRU0.js";import{C as At}from"../chunks/DMYMiB5a.js";import{t as Oe}from"../chunks/Cg4RV2pA.js";function rt(s,e,l){const t=s.slice();return t[19]=e[l],t}function st(s,e,l){const t=s.slice();return t[24]=e[l],t}function qe(s){const e=s.slice(),l=e[2].availableAlbums.find(r=>r.id===e[0]?.currentTrack?.albumId);e[22]=l;const t=e[22]?.tracks?.[e[0]?.currentTrack?.trackIndex??0];return e[23]=t,e}function St(s){let e,l,t,r,a,f,c,u,p,n="â† Salir de la Sala",b,w,C=s[0].name+"",I,x,y,m,T=s[0].hostName+"",R,S,k,D,j,M,Y="ðŸ“‹ Copiar Enlace",q,A,L,H,G,oe,_e,Ae,ce,Z,ee,se,ze="ðŸ‘¥",Se,te,Le,ue=s[4].length+"",he,Ne,Re,le,K=[],Fe=new Map,re,je,Ge;t=new At({});let B=s[1]&&at(),O=s[1]&&it(s);function Je(v,N){return v[0].currentTrack?Rt:Nt}let pe=Je(s),Q=pe(s);function Ke(v,N){return v[0].currentTrack?Mt:v[1]?Ht:jt}let ve=Ke(s),W=ve(s),U=s[1]&&ut(),be=Pe(s[4]);const We=v=>v[19].uid;for(let v=0;v<be.length;v+=1){let N=rt(s,be,v),$=We(N);Fe.set($,K[v]=mt($,N))}return{c(){e=h("div"),l=h("div"),Et(t.$$.fragment),r=P(),a=h("div"),f=h("div"),c=h("div"),u=h("div"),p=h("button"),p.textContent=n,b=P(),w=h("h1"),I=F(C),x=P(),y=h("p"),m=F("Host: "),R=F(T),S=P(),B&&B.c(),k=P(),D=h("div"),O&&O.c(),j=P(),M=h("button"),M.textContent=Y,q=P(),A=h("div"),L=h("div"),H=h("div"),G=h("h2"),Q.c(),oe=P(),W.c(),_e=P(),U&&U.c(),Ae=P(),ce=h("div"),Z=h("div"),ee=h("h3"),se=h("span"),se.textContent=ze,Se=P(),te=h("span"),Le=F("Participantes ("),he=F(ue),Ne=F(")"),Re=P(),le=h("div");for(let v=0;v<K.length;v+=1)K[v].c();this.h()},l(v){e=_(v,"DIV",{class:!0});var N=g(e);l=_(N,"DIV",{class:!0});var $=g(l);It(t.$$.fragment,$),$.forEach(i),r=V(N),a=_(N,"DIV",{class:!0});var Ye=g(a);f=_(Ye,"DIV",{class:!0});var ke=g(f);c=_(ke,"DIV",{class:!0});var ge=g(c);u=_(ge,"DIV",{});var ae=g(u);p=_(ae,"BUTTON",{class:!0,"data-svelte-h":!0}),J(p)!=="svelte-1uuzfzp"&&(p.textContent=n),b=V(ae),w=_(ae,"H1",{class:!0});var $e=g(w);I=z($e,C),$e.forEach(i),x=V(ae),y=_(ae,"P",{class:!0});var de=g(y);m=z(de,"Host: "),R=z(de,T),S=V(de),B&&B.l(de),de.forEach(i),ae.forEach(i),k=V(ge),D=_(ge,"DIV",{class:!0});var xe=g(D);O&&O.l(xe),j=V(xe),M=_(xe,"BUTTON",{class:!0,"data-svelte-h":!0}),J(M)!=="svelte-1b72jsd"&&(M.textContent=Y),xe.forEach(i),ge.forEach(i),q=V(ke),A=_(ke,"DIV",{class:!0});var ye=g(A);L=_(ye,"DIV",{class:!0});var Qe=g(L);H=_(Qe,"DIV",{class:!0});var ie=g(H);G=_(ie,"H2",{class:!0});var Xe=g(G);Q.l(Xe),Xe.forEach(i),oe=V(ie),W.l(ie),_e=V(ie),U&&U.l(ie),ie.forEach(i),Qe.forEach(i),Ae=V(ye),ce=_(ye,"DIV",{});var Ze=g(ce);Z=_(Ze,"DIV",{class:!0});var Ie=g(Z);ee=_(Ie,"H3",{class:!0});var Ee=g(ee);se=_(Ee,"SPAN",{"data-svelte-h":!0}),J(se)!=="svelte-240bj8"&&(se.textContent=ze),Se=V(Ee),te=_(Ee,"SPAN",{});var we=g(te);Le=z(we,"Participantes ("),he=z(we,ue),Ne=z(we,")"),we.forEach(i),Ee.forEach(i),Re=V(Ie),le=_(Ie,"DIV",{class:!0});var et=g(le);for(let He=0;He<K.length;He+=1)K[He].l(et);et.forEach(i),Ie.forEach(i),Ze.forEach(i),ye.forEach(i),ke.forEach(i),Ye.forEach(i),N.forEach(i),this.h()},h(){d(l,"class","absolute inset-0"),d(p,"class","text-slate-400 hover:text-white mb-2 flex items-center gap-2"),d(w,"class","text-3xl font-bold"),d(y,"class","text-slate-400 text-sm"),d(M,"class","flex-1 md:flex-none px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all text-sm font-medium whitespace-nowrap"),d(D,"class","flex items-center gap-3 w-full md:w-auto"),d(c,"class","flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"),d(G,"class","text-xl font-bold mb-4"),d(H,"class","bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-8"),d(L,"class","lg:col-span-2"),d(ee,"class","text-lg font-bold mb-4 flex items-center gap-2"),d(le,"class","space-y-3"),d(Z,"class","bg-black/40 backdrop-blur-xl border border-white/10 rounded-3xl p-6 sticky top-8"),d(A,"class","grid grid-cols-1 lg:grid-cols-3 gap-6"),d(f,"class","max-w-6xl mx-auto"),d(a,"class","relative z-10 min-h-screen text-white font-poppins px-4 py-8 md:p-8"),d(e,"class","relative min-h-screen overflow-hidden")},m(v,N){E(v,e,N),o(e,l),yt(t,l,null),o(e,r),o(e,a),o(a,f),o(f,c),o(c,u),o(u,p),o(u,b),o(u,w),o(w,I),o(u,x),o(u,y),o(y,m),o(y,R),o(y,S),B&&B.m(y,null),o(c,k),o(c,D),O&&O.m(D,null),o(D,j),o(D,M),o(f,q),o(f,A),o(A,L),o(L,H),o(H,G),Q.m(G,null),o(H,oe),W.m(H,null),o(H,_e),U&&U.m(H,null),o(A,Ae),o(A,ce),o(ce,Z),o(Z,ee),o(ee,se),o(ee,Se),o(ee,te),o(te,Le),o(te,he),o(te,Ne),o(Z,Re),o(Z,le);for(let $=0;$<K.length;$+=1)K[$]&&K[$].m(le,null);re=!0,je||(Ge=[De(p,"click",s[9]),De(M,"click",s[7])],je=!0)},p(v,N){(!re||N&1)&&C!==(C=v[0].name+"")&&X(I,C),(!re||N&1)&&T!==(T=v[0].hostName+"")&&X(R,T),v[1]?B||(B=at(),B.c(),B.m(y,null)):B&&(B.d(1),B=null),v[1]?O?O.p(v,N):(O=it(v),O.c(),O.m(D,j)):O&&(O.d(1),O=null),pe!==(pe=Je(v))&&(Q.d(1),Q=pe(v),Q&&(Q.c(),Q.m(G,null))),ve===(ve=Ke(v))&&W?W.p(v,N):(W.d(1),W=ve(v),W&&(W.c(),W.m(H,_e))),v[1]?U||(U=ut(),U.c(),U.m(H,null)):U&&(U.d(1),U=null),(!re||N&16)&&ue!==(ue=v[4].length+"")&&X(he,ue),N&49&&(be=Pe(v[4]),K=Ct(K,N,We,1,v,be,Fe,le,Dt,mt,null,rt))},i(v){re||(Ue(t.$$.fragment,v),re=!0)},o(v){Be(t.$$.fragment,v),re=!1},d(v){v&&i(e),gt(t),B&&B.d(),O&&O.d(),Q.d(),W.d(),U&&U.d();for(let N=0;N<K.length;N+=1)K[N].d();je=!1,xt(Ge)}}}function Lt(s){let e,l='<div class="text-center"><div class="inline-block w-16 h-16 border-4 border-primary-500 border-t-transparent rounded-full animate-spin mb-4"></div> <p class="text-slate-400">Conectando...</p></div>';return{c(){e=h("div"),e.innerHTML=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-k1cejf"&&(e.innerHTML=l),this.h()},h(){d(e,"class","min-h-screen bg-[#0B1120] text-white font-poppins flex items-center justify-center")},m(t,r){E(t,e,r)},p:me,i:me,o:me,d(t){t&&i(e)}}}function at(s){let e,l="(TÃº)";return{c(){e=h("span"),e.textContent=l,this.h()},l(t){e=_(t,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-ic3m7w"&&(e.textContent=l),this.h()},h(){d(e,"class","text-primary-400 font-bold ml-2")},m(t,r){E(t,e,r)},d(t){t&&i(e)}}}function it(s){let e,l="Cerrar Sala",t,r;return{c(){e=h("button"),e.textContent=l,this.h()},l(a){e=_(a,"BUTTON",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-40mafr"&&(e.textContent=l),this.h()},h(){d(e,"class","flex-1 md:flex-none px-4 py-2 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg transition-all text-sm font-medium border border-red-500/20 whitespace-nowrap")},m(a,f){E(a,e,f),t||(r=De(e,"click",s[10]),t=!0)},p:me,d(a){a&&i(e),t=!1,r()}}}function Nt(s){let e;return{c(){e=F("ðŸŽµ Esperando mÃºsica...")},l(l){e=z(l,"ðŸŽµ Esperando mÃºsica...")},m(l,t){E(l,e,t)},d(l){l&&i(e)}}}function Rt(s){let e;return{c(){e=F("ðŸŽµ Reproduciendo")},l(l){e=z(l,"ðŸŽµ Reproduciendo")},m(l,t){E(l,e,t)},d(l){l&&i(e)}}}function jt(s){let e,l="<p>El host aÃºn no ha reproducido nada.</p>";return{c(){e=h("div"),e.innerHTML=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-dnto5"&&(e.innerHTML=l),this.h()},h(){d(e,"class","text-center py-12 text-slate-500")},m(t,r){E(t,e,r)},p:me,d(t){t&&i(e)}}}function Ht(s){let e,l,t=`Selecciona un Ã¡lbum para empezar a\r
                                        escuchar juntos`,r,a,f=Pe(s[2].availableAlbums),c=[];for(let u=0;u<f.length;u+=1)c[u]=nt(st(s,f,u));return{c(){e=h("div"),l=h("p"),l.textContent=t,r=P(),a=h("div");for(let u=0;u<c.length;u+=1)c[u].c();this.h()},l(u){e=_(u,"DIV",{class:!0});var p=g(e);l=_(p,"P",{class:!0,"data-svelte-h":!0}),J(l)!=="svelte-1ebe0br"&&(l.textContent=t),r=V(p),a=_(p,"DIV",{class:!0});var n=g(a);for(let b=0;b<c.length;b+=1)c[b].l(n);n.forEach(i),p.forEach(i),this.h()},h(){d(l,"class","text-slate-400 mb-6"),d(a,"class","grid grid-cols-2 md:grid-cols-3 gap-4 max-h-96 overflow-y-auto px-4"),d(e,"class","text-center py-8")},m(u,p){E(u,e,p),o(e,l),o(e,r),o(e,a);for(let n=0;n<c.length;n+=1)c[n]&&c[n].m(a,null)},p(u,p){if(p&68){f=Pe(u[2].availableAlbums);let n;for(n=0;n<f.length;n+=1){const b=st(u,f,n);c[n]?c[n].p(b,p):(c[n]=nt(b),c[n].c(),c[n].m(a,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=f.length}},d(u){u&&i(e),wt(c,u)}}}function Mt(s){let e,l=s[0].currentTrack&&ot(qe(s));return{c(){l&&l.c(),e=Ce()},l(t){l&&l.l(t),e=Ce()},m(t,r){l&&l.m(t,r),E(t,e,r)},p(t,r){t[0].currentTrack?l?l.p(qe(t),r):(l=ot(qe(t)),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){t&&i(e),l&&l.d(t)}}}function nt(s){let e,l,t,r,a,f,c,u,p=s[24].title+"",n,b,w,C=s[24].artist+"",I,x,y,m;function T(){return s[11](s[24])}return{c(){e=h("button"),l=h("img"),a=P(),f=h("div"),c=h("div"),u=h("p"),n=F(p),b=P(),w=h("p"),I=F(C),x=P(),this.h()},l(R){e=_(R,"BUTTON",{class:!0});var S=g(e);l=_(S,"IMG",{src:!0,alt:!0,class:!0}),a=V(S),f=_(S,"DIV",{class:!0});var k=g(f);c=_(k,"DIV",{class:!0});var D=g(c);u=_(D,"P",{class:!0});var j=g(u);n=z(j,p),j.forEach(i),b=V(D),w=_(D,"P",{class:!0});var M=g(w);I=z(M,C),M.forEach(i),D.forEach(i),k.forEach(i),x=V(S),S.forEach(i),this.h()},h(){Ve(l.src,t=s[24].cover)||d(l,"src",t),d(l,"alt",r=s[24].title),d(l,"class","w-full aspect-square object-cover"),d(u,"class","text-sm font-bold text-white"),d(w,"class","text-xs text-slate-300"),d(c,"class","text-center p-2"),d(f,"class","absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"),d(e,"class","group relative rounded-xl overflow-hidden hover:scale-105 transition-transform")},m(R,S){E(R,e,S),o(e,l),o(e,a),o(e,f),o(f,c),o(c,u),o(u,n),o(c,b),o(c,w),o(w,I),o(e,x),y||(m=De(e,"click",T),y=!0)},p(R,S){s=R,S&4&&!Ve(l.src,t=s[24].cover)&&d(l,"src",t),S&4&&r!==(r=s[24].title)&&d(l,"alt",r),S&4&&p!==(p=s[24].title+"")&&X(n,p),S&4&&C!==(C=s[24].artist+"")&&X(I,C)},d(R){R&&i(e),y=!1,m()}}}function ot(s){let e,l=s[22]&&s[23]&&ct(s);return{c(){e=h("div"),l&&l.c(),this.h()},l(t){e=_(t,"DIV",{class:!0});var r=g(e);l&&l.l(r),r.forEach(i),this.h()},h(){d(e,"class","text-center")},m(t,r){E(t,e,r),l&&l.m(e,null)},p(t,r){t[22]&&t[23]?l?l.p(t,r):(l=ct(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(t){t&&i(e),l&&l.d()}}}function ct(s){let e,l,t,r,a,f=s[23].title+"",c,u,p,n=(s[23].artist||s[22].artist)+"",b,w,C;function I(m,T){return m[0].currentTrack.isPlaying?qt:Ot}let x=I(s),y=x(s);return{c(){e=h("img"),r=P(),a=h("h3"),c=F(f),u=P(),p=h("p"),b=F(n),w=P(),C=h("div"),y.c(),this.h()},l(m){e=_(m,"IMG",{src:!0,alt:!0,class:!0}),r=V(m),a=_(m,"H3",{class:!0});var T=g(a);c=z(T,f),T.forEach(i),u=V(m),p=_(m,"P",{class:!0});var R=g(p);b=z(R,n),R.forEach(i),w=V(m),C=_(m,"DIV",{class:!0});var S=g(C);y.l(S),S.forEach(i),this.h()},h(){Ve(e.src,l=s[22].cover)||d(e,"src",l),d(e,"alt",t=s[22].title),d(e,"class","w-64 h-64 mx-auto rounded-2xl shadow-2xl mb-6"),d(a,"class","text-2xl font-bold mb-2"),d(p,"class","text-slate-400 mb-4"),d(C,"class","flex items-center justify-center gap-2")},m(m,T){E(m,e,T),E(m,r,T),E(m,a,T),o(a,c),E(m,u,T),E(m,p,T),o(p,b),E(m,w,T),E(m,C,T),y.m(C,null)},p(m,T){T&5&&!Ve(e.src,l=m[22].cover)&&d(e,"src",l),T&5&&t!==(t=m[22].title)&&d(e,"alt",t),T&5&&f!==(f=m[23].title+"")&&X(c,f),T&5&&n!==(n=(m[23].artist||m[22].artist)+"")&&X(b,n),x!==(x=I(m))&&(y.d(1),y=x(m),y&&(y.c(),y.m(C,null)))},d(m){m&&(i(e),i(r),i(a),i(u),i(p),i(w),i(C)),y.d()}}}function Ot(s){let e,l,t,r="Pausado";return{c(){e=h("div"),l=P(),t=h("span"),t.textContent=r,this.h()},l(a){e=_(a,"DIV",{class:!0}),g(e).forEach(i),l=V(a),t=_(a,"SPAN",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-t7ul9k"&&(t.textContent=r),this.h()},h(){d(e,"class","w-3 h-3 bg-slate-500 rounded-full"),d(t,"class","text-slate-500 text-sm font-bold")},m(a,f){E(a,e,f),E(a,l,f),E(a,t,f)},d(a){a&&(i(e),i(l),i(t))}}}function qt(s){let e,l,t,r="Reproduciendo";return{c(){e=h("div"),l=P(),t=h("span"),t.textContent=r,this.h()},l(a){e=_(a,"DIV",{class:!0}),g(e).forEach(i),l=V(a),t=_(a,"SPAN",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-fc5aqd"&&(t.textContent=r),this.h()},h(){d(e,"class","w-3 h-3 bg-green-400 rounded-full animate-pulse"),d(t,"class","text-green-400 text-sm font-bold")},m(a,f){E(a,e,f),E(a,l,f),E(a,t,f)},d(a){a&&(i(e),i(l),i(t))}}}function ut(s){let e,l=`<p class="text-sm text-primary-300">ðŸ’¡ Como host, los controles en /app se
                                        sincronizarÃ¡n automÃ¡ticamente aquÃ­.</p>`;return{c(){e=h("div"),e.innerHTML=l,this.h()},l(t){e=_(t,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-ikpvgi"&&(e.innerHTML=l),this.h()},h(){d(e,"class","mt-6 p-4 bg-primary-500/10 border border-primary-500/20 rounded-xl")},m(t,r){E(t,e,r)},d(t){t&&i(e)}}}function dt(s){let e,l="Host";return{c(){e=h("p"),e.textContent=l,this.h()},l(t){e=_(t,"P",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-v8jxyn"&&(e.textContent=l),this.h()},h(){d(e,"class","text-xs text-primary-400")},m(t,r){E(t,e,r)},d(t){t&&i(e)}}}function ft(s){let e,l="(TÃº)";return{c(){e=h("span"),e.textContent=l,this.h()},l(t){e=_(t,"SPAN",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-199xcym"&&(e.textContent=l),this.h()},h(){d(e,"class","text-xs text-slate-500")},m(t,r){E(t,e,r)},d(t){t&&i(e)}}}function mt(s,e){let l,t,r=(e[19].name[0]?.toUpperCase()||"?")+"",a,f,c,u,p=e[19].name+"",n,b,w,C,I=e[19].uid===e[0].hostId&&dt(),x=e[19].uid===e[5].user?.uid&&ft();return{key:s,first:null,c(){l=h("div"),t=h("div"),a=F(r),f=P(),c=h("div"),u=h("p"),n=F(p),b=P(),I&&I.c(),w=P(),x&&x.c(),C=P(),this.h()},l(y){l=_(y,"DIV",{class:!0});var m=g(l);t=_(m,"DIV",{class:!0});var T=g(t);a=z(T,r),T.forEach(i),f=V(m),c=_(m,"DIV",{class:!0});var R=g(c);u=_(R,"P",{class:!0});var S=g(u);n=z(S,p),S.forEach(i),b=V(R),I&&I.l(R),R.forEach(i),w=V(m),x&&x.l(m),C=V(m),m.forEach(i),this.h()},h(){d(t,"class","w-10 h-10 rounded-full bg-gradient-to-br from-primary-500 to-orange-500 flex items-center justify-center text-sm font-bold"),d(u,"class","text-sm font-medium"),d(c,"class","flex-1"),d(l,"class","flex items-center gap-3 p-3 bg-white/5 rounded-xl"),this.first=l},m(y,m){E(y,l,m),o(l,t),o(t,a),o(l,f),o(l,c),o(c,u),o(u,n),o(c,b),I&&I.m(c,null),o(l,w),x&&x.m(l,null),o(l,C)},p(y,m){e=y,m&16&&r!==(r=(e[19].name[0]?.toUpperCase()||"?")+"")&&X(a,r),m&16&&p!==(p=e[19].name+"")&&X(n,p),e[19].uid===e[0].hostId?I||(I=dt(),I.c(),I.m(c,null)):I&&(I.d(1),I=null),e[19].uid===e[5].user?.uid?x||(x=ft(),x.c(),x.m(l,C)):x&&(x.d(1),x=null)},d(y){y&&i(l),I&&I.d(),x&&x.d()}}}function Bt(s){let e,l,t,r,a,f;document.title=e=(s[0]?.name||"Sala")+" | ChillChess";const c=[Lt,St],u=[];function p(n,b){return n[3]?0:n[0]?1:-1}return~(t=p(s))&&(r=u[t]=c[t](s)),{c(){l=P(),r&&r.c(),a=Ce()},l(n){bt("svelte-16d8z6n",document.head).forEach(i),l=V(n),r&&r.l(n),a=Ce()},m(n,b){E(n,l,b),~t&&u[t].m(n,b),E(n,a,b),f=!0},p(n,[b]){(!f||b&1)&&e!==(e=(n[0]?.name||"Sala")+" | ChillChess")&&(document.title=e);let w=t;t=p(n),t===w?~t&&u[t].p(n,b):(r&&(Tt(),Be(u[w],1,1,()=>{u[w]=null}),vt()),~t?(r=u[t],r?r.p(n,b):(r=u[t]=c[t](n),r.c()),Ue(r,1),r.m(a.parentNode,a)):r=null)},i(n){f||(Ue(r),f=!0)},o(n){Be(r),f=!1},d(n){n&&(i(l),i(a)),~t&&u[t].d(n)}}}function Ut(s,e,l){let t,r,a;Me(s,fe,k=>l(2,t=k)),Me(s,Pt,k=>l(5,r=k)),Me(s,Vt,k=>l(15,a=k));const f=a.params.id;let c=null,u=!0,p=!1,n=null,b=[];function w(k){lt(k)}kt(async()=>{if(!r.isLoggedIn){Te("/");return}const{doc:k,onSnapshot:D,updateDoc:j,serverTimestamp:M}=await ne(async()=>{const{doc:A,onSnapshot:L,updateDoc:H,serverTimestamp:G}=await import("../chunks/C9UhFrXA.js").then(oe=>oe.i);return{doc:A,onSnapshot:L,updateDoc:H,serverTimestamp:G}},__vite__mapDeps([0,1,2,3]),import.meta.url),{db:Y}=await ne(async()=>{const{db:A}=await import("../chunks/CSpmTaba.js").then(L=>L.ah);return{db:A}},[],import.meta.url),q=k(Y,"listeningRooms",f);if(n=D(q,A=>{if(!A.exists()){alert("Esta sala no existe."),Te("/rooms");return}const L=A.data();l(0,c=L),l(1,p=L.hostId===r.user?.uid),l(4,b=Object.entries(L.participants).map(([H,G])=>({uid:H,name:G.displayName}))),l(3,u=!1)}),r.user)try{await j(q,{[`participants.${r.user.uid}`]:{displayName:r.user.displayName||"Usuario",joinedAt:M()}})}catch(A){console.error("Error joining room:",A)}if(p){m();const A=fe.subscribe(async L=>{if(m(),!L.currentAlbumId)return;const H=L.playlist[L.currentTrackIndex];try{await j(q,{currentTrack:{albumId:L.currentAlbumId,trackIndex:L.currentTrackIndex,isPlaying:L.isPlaying,title:H?.title||"Unknown",timestamp:M()}})}catch(G){console.error("Error syncing:",G)}});tt(()=>{A(),x&&clearTimeout(x)})}}),tt(async()=>{if(n&&n(),r.isLoggedIn&&r.user)try{const{doc:k,updateDoc:D,deleteField:j}=await ne(async()=>{const{doc:q,updateDoc:A,deleteField:L}=await import("../chunks/C9UhFrXA.js").then(H=>H.i);return{doc:q,updateDoc:A,deleteField:L}},__vite__mapDeps([0,1,2,3]),import.meta.url),{db:M}=await ne(async()=>{const{db:q}=await import("../chunks/CSpmTaba.js").then(A=>A.ah);return{db:q}},[],import.meta.url),Y=k(M,"listeningRooms",f);await D(Y,{[`participants.${r.user.uid}`]:j()})}catch(k){console.error("Error leaving room:",k)}});function C(){const k=`${window.location.origin}/rooms/${f}`;navigator.clipboard.writeText(k),Oe.success("Enlace copiado al portapapeles")}async function I(k=!1){if(!(!k&&!confirm("Â¿EstÃ¡s seguro de que quieres cerrar esta sala permanentemente? Todos los participantes serÃ¡n desconectados.")))try{const{doc:D,deleteDoc:j}=await ne(async()=>{const{doc:Y,deleteDoc:q}=await import("../chunks/C9UhFrXA.js").then(A=>A.i);return{doc:Y,deleteDoc:q}},__vite__mapDeps([0,1,2,3]),import.meta.url),{db:M}=await ne(async()=>{const{db:Y}=await import("../chunks/CSpmTaba.js").then(q=>q.ah);return{db:Y}},[],import.meta.url);await j(D(M,"listeningRooms",f)),Oe.success(k?"Sala cerrada por inactividad (15 min)":"Sala cerrada exitosamente"),Te("/rooms")}catch(D){console.error("Error closing room:",D),Oe.error("Error al cerrar la sala")}}let x;const y=15*60*1e3;function m(){x&&clearTimeout(x),x=setTimeout(()=>{if(t.isPlaying){m();return}I(!0)},y)}const T=()=>Te("/rooms"),R=()=>I(!1),S=k=>w(k.id);return s.$$.update=()=>{if(s.$$.dirty&7&&c&&!p&&c.currentTrack&&t.availableAlbums.length>0){const k=c.currentTrack,D=t;k.albumId!==D.currentAlbumId?(lt(k.albumId),fe.update(j=>({...j,currentTrackIndex:k.trackIndex}))):k.trackIndex!==D.currentTrackIndex&&fe.update(j=>({...j,currentTrackIndex:k.trackIndex})),k.isPlaying!==D.isPlaying&&fe.update(j=>({...j,isPlaying:k.isPlaying}))}},[c,p,t,u,b,r,w,C,I,T,R,S]}class Zt extends _t{constructor(e){super(),ht(this,e,Ut,Bt,pt,{})}}export{Zt as component};
