import{s as we,n as $,d as p,m as xe,D as ke,a as s,E as ne,i as K,q as l,x as ee,b,l as k,g as J,r as A,A as te,t as Y,f as w,v as B,B as se,w as G,o as ye,p as X,N as Ee,O as De,J as Te}from"../chunks/BckIrkyu.js";import{S as Ce,i as Ie,a as ie,g as Le,t as Me,c as Ve,h as ce}from"../chunks/km8sfNIa.js";import{e as le,u as Ae,d as Be}from"../chunks/B19K-gfZ.js";import{u as He}from"../chunks/fE13p0Jv.js";import{g as je}from"../chunks/BkPvZzYy.js";import{q as Ne,c as Se,d as qe,e as Pe,l as ze,f as Re}from"../chunks/5dAqgG7A.js";import{s as de}from"../chunks/BXx5VT1W.js";function ue(a,e,t){const r=a.slice();r[14]=e[t];const o=r[5].has(r[14].id);return r[15]=o,r}function fe(a,e,t){const r=a.slice();return r[18]=e[t],r}function he(a){let e,t,r,o,d,_;function y(){return a[10](a[18])}return{c(){e=w("button"),t=G(a[18]),r=B(),this.h()},l(u){e=b(u,"BUTTON",{class:!0});var f=k(e);t=Y(f,a[18]),r=A(f),f.forEach(p),this.h()},h(){s(e,"class",o="px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all "+(a[1]===a[18]?"bg-primary-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"))},m(u,f){K(u,e,f),l(e,t),l(e,r),d||(_=ee(e,"click",y),d=!0)},p(u,f){a=u,f&2&&o!==(o="px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all "+(a[1]===a[18]?"bg-primary-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"))&&s(e,"class",o)},d(u){u&&p(e),d=!1,_()}}}function Ue(a){let e,t,r='<tr class="border-b border-white/5 bg-[#131B2D]"><th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest w-24">Nivel</th> <th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest w-40">Tiempo</th> <th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest">Mensaje</th></tr>',o,d,_=[],y=new Map,u=le(a[3]);const f=n=>n[14].id;for(let n=0;n<u.length;n+=1){let m=ue(a,u,n),E=f(m);y.set(E,_[n]=me(E,m))}return{c(){e=w("table"),t=w("thead"),t.innerHTML=r,o=B(),d=w("tbody");for(let n=0;n<_.length;n+=1)_[n].c();this.h()},l(n){e=b(n,"TABLE",{class:!0});var m=k(e);t=b(m,"THEAD",{"data-svelte-h":!0}),J(t)!=="svelte-4c9h6p"&&(t.innerHTML=r),o=A(m),d=b(m,"TBODY",{class:!0});var E=k(d);for(let V=0;V<_.length;V+=1)_[V].l(E);E.forEach(p),m.forEach(p),this.h()},h(){s(d,"class","text-sm font-mono divide-y divide-white/5"),s(e,"class","w-full text-left border-collapse")},m(n,m){K(n,e,m),l(e,t),l(e,o),l(e,d);for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(d,null)},p(n,m){m&168&&(u=le(n[3]),_=Ae(_,m,f,1,n,u,y,d,Be,me,null,ue))},d(n){n&&p(e);for(let m=0;m<_.length;m+=1)_[m].d()}}}function Oe(a){let e,t='<svg class="w-16 h-16 mb-4 opacity-20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="font-mono text-sm">No se encontraron registros</p>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(r){e=b(r,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-174fd2l"&&(e.innerHTML=t),this.h()},h(){s(e,"class","flex flex-col items-center justify-center py-24 text-slate-500")},m(r,o){K(r,e,o)},p:$,d(r){r&&p(e)}}}function Fe(a){let e,t='<div class="flex flex-col items-center"><div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-primary-500 mb-4"></div> <span class="text-primary-400 font-mono text-sm animate-pulse">Cargando datos...</span></div>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(r){e=b(r,"DIV",{class:!0,"data-svelte-h":!0}),J(e)!=="svelte-xapgf4"&&(e.innerHTML=t),this.h()},h(){s(e,"class","absolute inset-0 flex items-center justify-center bg-black/50 z-10 backdrop-blur-sm")},m(r,o){K(r,e,o)},p:$,d(r){r&&p(e)}}}function pe(a){let e,t,r;return{c(){e=se("svg"),t=se("path"),this.h()},l(o){e=te(o,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var d=k(e);t=te(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(t).forEach(p),d.forEach(p),this.h()},h(){s(t,"stroke-linecap","round"),s(t,"stroke-linejoin","round"),s(t,"stroke-width","2"),s(t,"d","M19 9l-7 7-7-7"),s(e,"class",r="w-4 h-4 text-slate-600 transform transition-transform "+(a[15]?"rotate-180":"")),s(e,"fill","none"),s(e,"stroke","currentColor"),s(e,"viewBox","0 0 24 24")},m(o,d){K(o,e,d),l(e,t)},p(o,d){d&40&&r!==(r="w-4 h-4 text-slate-600 transform transition-transform "+(o[15]?"rotate-180":""))&&s(e,"class",r)},d(o){o&&p(e)}}}function ve(a){let e,t,r="Detalles Técnicos",o,d,_=a[14].details+"",y,u,f,n,m,E="Usuario ID",V,L,M=(a[14].userId||"N/A")+"",i,T,D,I,U="User Agent",N,S,H=(a[14].userAgent||"N/A")+"",z,R,q,C;return{c(){e=w("div"),t=w("div"),t.textContent=r,o=B(),d=w("pre"),y=G(_),u=B(),f=w("div"),n=w("div"),m=w("span"),m.textContent=E,V=B(),L=w("span"),i=G(M),T=B(),D=w("div"),I=w("span"),I.textContent=U,N=B(),S=w("span"),z=G(H),this.h()},l(g){e=b(g,"DIV",{class:!0});var v=k(e);t=b(v,"DIV",{class:!0,"data-svelte-h":!0}),J(t)!=="svelte-1j3qeuq"&&(t.textContent=r),o=A(v),d=b(v,"PRE",{class:!0});var P=k(d);y=Y(P,_),P.forEach(p),u=A(v),f=b(v,"DIV",{class:!0});var c=k(f);n=b(c,"DIV",{});var h=k(n);m=b(h,"SPAN",{class:!0,"data-svelte-h":!0}),J(m)!=="svelte-1h4ae54"&&(m.textContent=E),V=A(h),L=b(h,"SPAN",{class:!0});var x=k(L);i=Y(x,M),x.forEach(p),h.forEach(p),T=A(c),D=b(c,"DIV",{});var j=k(D);I=b(j,"SPAN",{class:!0,"data-svelte-h":!0}),J(I)!=="svelte-rqfrz7"&&(I.textContent=U),N=A(j),S=b(j,"SPAN",{class:!0,title:!0});var O=k(S);z=Y(O,H),O.forEach(p),j.forEach(p),c.forEach(p),v.forEach(p),this.h()},h(){s(t,"class","text-[10px] text-slate-500 mb-2 uppercase tracking-wide"),s(d,"class","text-xs text-indigo-300 font-mono whitespace-pre-wrap max-h-60 overflow-y-auto custom-scrollbar svelte-vpf7wd"),s(m,"class","text-slate-500 block"),s(L,"class","text-slate-300 font-mono"),s(I,"class","text-slate-500 block"),s(S,"class","text-slate-300 font-mono truncate block"),s(S,"title",R=a[14].userAgent),s(f,"class","mt-3 pt-3 border-t border-white/5 grid grid-cols-2 gap-4 text-xs"),s(e,"class","mt-4 bg-black/40 rounded-lg p-4 border border-white/5 overflow-x-auto")},m(g,v){K(g,e,v),l(e,t),l(e,o),l(e,d),l(d,y),l(e,u),l(e,f),l(f,n),l(n,m),l(n,V),l(n,L),l(L,i),l(f,T),l(f,D),l(D,I),l(D,N),l(D,S),l(S,z),C=!0},p(g,v){(!C||v&8)&&_!==(_=g[14].details+"")&&X(y,_),(!C||v&8)&&M!==(M=(g[14].userId||"N/A")+"")&&X(i,M),(!C||v&8)&&H!==(H=(g[14].userAgent||"N/A")+"")&&X(z,H),(!C||v&8&&R!==(R=g[14].userAgent))&&s(S,"title",R)},i(g){C||(g&&Te(()=>{C&&(q||(q=ce(e,de,{duration:200},!0)),q.run(1))}),C=!0)},o(g){g&&(q||(q=ce(e,de,{duration:200},!1)),q.run(0)),C=!1},d(g){g&&p(e),g&&q&&q.end()}}}function me(a,e){let t,r,o,d,_=_e(e[14].level)+"",y,u=e[14].level+"",f,n,m,E,V=be(e[14].timestamp)+"",L,M,i,T,D,I=e[14].message+"",U,N,S,H,z,R,q,C,g=e[14].details&&pe(e),v=e[15]&&e[14].details&&ve(e);function P(){return e[11](e[14])}return{key:a,first:null,c(){t=w("tr"),r=w("td"),o=w("div"),d=new De(!1),y=B(),f=G(u),m=B(),E=w("td"),L=G(V),M=B(),i=w("td"),T=w("div"),D=w("span"),U=G(I),S=B(),g&&g.c(),H=B(),v&&v.c(),z=B(),this.h()},l(c){t=b(c,"TR",{class:!0});var h=k(t);r=b(h,"TD",{class:!0});var x=k(r);o=b(x,"DIV",{class:!0});var j=k(o);d=Ee(j,!1),y=A(j),f=Y(j,u),j.forEach(p),x.forEach(p),m=A(h),E=b(h,"TD",{class:!0});var O=k(E);L=Y(O,V),O.forEach(p),M=A(h),i=b(h,"TD",{class:!0});var F=k(i);T=b(F,"DIV",{class:!0});var Q=k(T);D=b(Q,"SPAN",{class:!0});var W=k(D);U=Y(W,I),W.forEach(p),S=A(Q),g&&g.l(Q),Q.forEach(p),H=A(F),v&&v.l(F),F.forEach(p),z=A(h),h.forEach(p),this.h()},h(){d.a=y,s(o,"class",n="flex items-center gap-2 "+ge(e[14].level)+" px-2 py-1 rounded w-fit border text-[10px] font-bold uppercase tracking-wider svelte-vpf7wd"),s(r,"class","py-3 px-6 whitespace-nowrap align-top"),s(E,"class","py-4 px-6 whitespace-nowrap text-slate-500 align-top text-xs"),s(D,"class",N="break-all "+(e[14].level==="error"?"text-rose-200":"")),s(T,"class","flex items-start justify-between gap-4"),s(i,"class","py-4 px-6 text-slate-300 align-top"),s(t,"class",R="hover:bg-white/[0.02] transition-colors cursor-pointer group "+(e[15]?"bg-white/[0.02]":"")),this.first=t},m(c,h){K(c,t,h),l(t,r),l(r,o),d.m(_,o),l(o,y),l(o,f),l(t,m),l(t,E),l(E,L),l(t,M),l(t,i),l(i,T),l(T,D),l(D,U),l(T,S),g&&g.m(T,null),l(i,H),v&&v.m(i,null),l(t,z),q||(C=ee(t,"click",P),q=!0)},p(c,h){e=c,h&8&&_!==(_=_e(e[14].level)+"")&&d.p(_),h&8&&u!==(u=e[14].level+"")&&X(f,u),h&8&&n!==(n="flex items-center gap-2 "+ge(e[14].level)+" px-2 py-1 rounded w-fit border text-[10px] font-bold uppercase tracking-wider svelte-vpf7wd")&&s(o,"class",n),h&8&&V!==(V=be(e[14].timestamp)+"")&&X(L,V),h&8&&I!==(I=e[14].message+"")&&X(U,I),h&8&&N!==(N="break-all "+(e[14].level==="error"?"text-rose-200":""))&&s(D,"class",N),e[14].details?g?g.p(e,h):(g=pe(e),g.c(),g.m(T,null)):g&&(g.d(1),g=null),e[15]&&e[14].details?v?(v.p(e,h),h&40&&ie(v,1)):(v=ve(e),v.c(),ie(v,1),v.m(i,null)):v&&(Le(),Me(v,1,1,()=>{v=null}),Ve()),h&40&&R!==(R="hover:bg-white/[0.02] transition-colors cursor-pointer group "+(e[15]?"bg-white/[0.02]":""))&&s(t,"class",R)},d(c){c&&p(t),g&&g.d(),v&&v.d(),q=!1,C()}}}function Je(a){let e,t,r,o,d=`<h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-primary-200 to-primary-400 tracking-tight mb-2">System Logs</h1> <p class="text-slate-400 font-mono text-sm flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    Sistema en línea • Monitoreo activo</p>`,_,y,u,f,n,m,E,V,L,M,i,T='<svg class="h-4 w-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',D,I,U,N,S,H,z,R,q=le(["all","error","warn","info"]),C=[];for(let c=0;c<4;c+=1)C[c]=he(fe(a,q,c));function g(c,h){return c[4]&&c[0].length===0?Fe:c[3].length===0?Oe:Ue}let v=g(a),P=v(a);return{c(){e=w("div"),t=w("div"),r=w("div"),o=w("div"),o.innerHTML=d,_=B(),y=w("div"),u=w("button"),f=se("svg"),n=se("path"),E=G(`\r
                    Refresh`),V=B(),L=w("div"),M=w("div"),i=w("div"),i.innerHTML=T,D=B(),I=w("input"),U=B(),N=w("div");for(let c=0;c<4;c+=1)C[c].c();S=B(),H=w("div"),P.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var h=k(e);t=b(h,"DIV",{class:!0});var x=k(t);r=b(x,"DIV",{class:!0});var j=k(r);o=b(j,"DIV",{"data-svelte-h":!0}),J(o)!=="svelte-t2e20b"&&(o.innerHTML=d),_=A(j),y=b(j,"DIV",{class:!0});var O=k(y);u=b(O,"BUTTON",{class:!0});var F=k(u);f=te(F,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var Q=k(f);n=te(Q,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),k(n).forEach(p),Q.forEach(p),E=Y(F,`\r
                    Refresh`),F.forEach(p),O.forEach(p),j.forEach(p),V=A(x),L=b(x,"DIV",{class:!0});var W=k(L);M=b(W,"DIV",{class:!0});var Z=k(M);i=b(Z,"DIV",{class:!0,"data-svelte-h":!0}),J(i)!=="svelte-1xncy8t"&&(i.innerHTML=T),D=A(Z),I=b(Z,"INPUT",{type:!0,placeholder:!0,class:!0}),Z.forEach(p),U=A(W),N=b(W,"DIV",{class:!0});var ae=k(N);for(let re=0;re<4;re+=1)C[re].l(ae);ae.forEach(p),W.forEach(p),S=A(x),H=b(x,"DIV",{class:!0});var oe=k(H);P.l(oe),oe.forEach(p),x.forEach(p),h.forEach(p),this.h()},h(){s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"stroke-width","2"),s(n,"d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"),s(f,"class",m="w-4 h-4 "+(a[4]?"animate-spin":"")),s(f,"fill","none"),s(f,"stroke","currentColor"),s(f,"viewBox","0 0 24 24"),s(u,"class","px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all text-sm font-medium flex items-center gap-2 active:scale-95"),u.disabled=a[4],s(y,"class","flex gap-3"),s(r,"class","flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10"),s(i,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),s(I,"type","text"),s(I,"placeholder","Buscar en logs..."),s(I,"class","block w-full pl-10 pr-3 py-2.5 border border-white/10 rounded-xl leading-5 bg-black/20 text-slate-300 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500/50 sm:text-sm transition-all"),s(M,"class","relative flex-1"),s(N,"class","flex p-1 bg-black/20 rounded-xl border border-white/5"),s(L,"class","bg-[#131B2D] border border-white/5 rounded-2xl p-4 mb-8 flex flex-col md:flex-row gap-4 shadow-xl"),s(H,"class","bg-[#0f1623] border border-white/5 rounded-2xl overflow-hidden shadow-2xl relative min-h-[400px]"),s(t,"class","max-w-7xl mx-auto"),s(e,"class","min-h-screen bg-[#0B1120] text-slate-300 font-sans p-6 md:p-12 pb-24")},m(c,h){K(c,e,h),l(e,t),l(t,r),l(r,o),l(r,_),l(r,y),l(y,u),l(u,f),l(f,n),l(u,E),l(t,V),l(t,L),l(L,M),l(M,i),l(M,D),l(M,I),ne(I,a[2]),l(L,U),l(L,N);for(let x=0;x<4;x+=1)C[x]&&C[x].m(N,null);l(t,S),l(t,H),P.m(H,null),z||(R=[ee(u,"click",a[6]),ee(I,"input",a[9])],z=!0)},p(c,[h]){if(h&16&&m!==(m="w-4 h-4 "+(c[4]?"animate-spin":""))&&s(f,"class",m),h&16&&(u.disabled=c[4]),h&4&&I.value!==c[2]&&ne(I,c[2]),h&258){q=le(["all","error","warn","info"]);let x;for(x=0;x<4;x+=1){const j=fe(c,q,x);C[x]?C[x].p(j,h):(C[x]=he(j),C[x].c(),C[x].m(N,null))}for(;x<4;x+=1)C[x].d(1)}v===(v=g(c))&&P?P.p(c,h):(P.d(1),P=v(c),P&&(P.c(),P.m(H,null)))},i:$,o:$,d(c){c&&p(e),xe(C,c),P.d(),z=!1,ke(R)}}}function _e(a){switch(a){case"error":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';case"warn":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>';default:return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>'}}function ge(a){switch(a){case"error":return"text-rose-400 bg-rose-500/10 border-rose-500/20 shadow-[0_0_10px_rgba(251,113,133,0.2)]";case"warn":return"text-amber-400 bg-amber-500/10 border-amber-500/20 shadow-[0_0_10px_rgba(251,191,36,0.2)]";default:return"text-primary-400 bg-primary-500/10 border-primary-500/20 shadow-[0_0_10px_rgba(255,123,61,0.2)]"}}function be(a){return a?new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",day:"2-digit",month:"short"}).format(a):"-"}function Ye(a,e,t){let r=[],o=[],d=!0,_="all",y="",u=new Set;ye(()=>He.subscribe(async T=>{if(!T.loading){if(!T.profile?.isAdmin){je("/");return}await f(),t(4,d=!1)}}));async function f(){try{t(4,d=!0);const i=Ne(Se(qe,"system_logs"),Pe("timestamp","desc"),ze(100)),T=await Re(i);t(0,r=T.docs.map(D=>({id:D.id,...D.data(),timestamp:D.data().timestamp?.toDate()}))),n()}catch(i){console.error("Error loading logs:",i),i.message}finally{t(4,d=!1)}}function n(){let i=[...r];if(_!=="all"&&(i=i.filter(T=>T.level===_)),y){const T=y.toLowerCase();i=i.filter(D=>D.message.toLowerCase().includes(T)||D.details&&D.details.toLowerCase().includes(T))}t(3,o=i)}function m(i){u.has(i)?u.delete(i):u.add(i),t(5,u)}function E(i){t(1,_=i)}function V(){y=this.value,t(2,y)}const L=i=>E(i),M=i=>m(i.id);return a.$$.update=()=>{a.$$.dirty&7&&r.length&&n()},[r,_,y,o,d,u,f,m,E,V,L,M]}class et extends Ce{constructor(e){super(),Ie(this,e,Ye,Je,we,{})}}export{et as component};
