import{s as we,n as $,d as p,w as ke,r as xe,g as s,x as ne,i as K,p as l,q as ee,j as b,t as x,k as Y,c as B,B as te,u as G,l as w,a as A,C as se,v as J,o as ye,m as X,H as Ee,I as De,z as Ce}from"../chunks/CjRJOMMO.js";import{S as Te,i as Ie,a as ie,g as Le,t as Me,e as Ve,f as de}from"../chunks/CrctwSd_.js";import{e as le,u as Be,d as Ae}from"../chunks/YP0ceSnB.js";import{u as je}from"../chunks/vh9DsmAz.js";import{g as He}from"../chunks/1_Ok31BQ.js";import{q as Ne,c as Se,d as qe,o as ze,l as Pe,g as Re}from"../chunks/CRduKRiI.js";import{s as ce}from"../chunks/BYgGvtrc.js";function ue(a,e,t){const r=a.slice();r[14]=e[t];const o=r[5].has(r[14].id);return r[15]=o,r}function fe(a,e,t){const r=a.slice();return r[18]=e[t],r}function he(a){let e,t,r,o,c,_;function y(){return a[10](a[18])}return{c(){e=w("button"),t=J(a[18]),r=A(),this.h()},l(u){e=b(u,"BUTTON",{class:!0});var f=x(e);t=G(f,a[18]),r=B(f),f.forEach(p),this.h()},h(){s(e,"class",o="px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all "+(a[1]===a[18]?"bg-indigo-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"))},m(u,f){K(u,e,f),l(e,t),l(e,r),c||(_=ee(e,"click",y),c=!0)},p(u,f){a=u,f&2&&o!==(o="px-4 py-1.5 rounded-lg text-xs font-bold uppercase tracking-wider transition-all "+(a[1]===a[18]?"bg-indigo-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"))&&s(e,"class",o)},d(u){u&&p(e),c=!1,_()}}}function Ue(a){let e,t,r='<tr class="border-b border-white/5 bg-[#131B2D]"><th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest w-24">Nivel</th> <th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest w-40">Tiempo</th> <th class="py-3 px-6 text-[10px] font-bold text-slate-500 uppercase tracking-widest">Mensaje</th></tr>',o,c,_=[],y=new Map,u=le(a[3]);const f=n=>n[14].id;for(let n=0;n<u.length;n+=1){let m=ue(a,u,n),E=f(m);y.set(E,_[n]=me(E,m))}return{c(){e=w("table"),t=w("thead"),t.innerHTML=r,o=A(),c=w("tbody");for(let n=0;n<_.length;n+=1)_[n].c();this.h()},l(n){e=b(n,"TABLE",{class:!0});var m=x(e);t=b(m,"THEAD",{"data-svelte-h":!0}),Y(t)!=="svelte-4c9h6p"&&(t.innerHTML=r),o=B(m),c=b(m,"TBODY",{class:!0});var E=x(c);for(let V=0;V<_.length;V+=1)_[V].l(E);E.forEach(p),m.forEach(p),this.h()},h(){s(c,"class","text-sm font-mono divide-y divide-white/5"),s(e,"class","w-full text-left border-collapse")},m(n,m){K(n,e,m),l(e,t),l(e,o),l(e,c);for(let E=0;E<_.length;E+=1)_[E]&&_[E].m(c,null)},p(n,m){m&168&&(u=le(n[3]),_=Be(_,m,f,1,n,u,y,c,Ae,me,null,ue))},d(n){n&&p(e);for(let m=0;m<_.length;m+=1)_[m].d()}}}function Oe(a){let e,t='<svg class="w-16 h-16 mb-4 opacity-20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <p class="font-mono text-sm">No se encontraron registros</p>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(r){e=b(r,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-174fd2l"&&(e.innerHTML=t),this.h()},h(){s(e,"class","flex flex-col items-center justify-center py-24 text-slate-500")},m(r,o){K(r,e,o)},p:$,d(r){r&&p(e)}}}function Fe(a){let e,t='<div class="flex flex-col items-center"><div class="animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-indigo-500 mb-4"></div> <span class="text-indigo-400 font-mono text-sm animate-pulse">Cargando datos...</span></div>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(r){e=b(r,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-je144e"&&(e.innerHTML=t),this.h()},h(){s(e,"class","absolute inset-0 flex items-center justify-center bg-black/50 z-10 backdrop-blur-sm")},m(r,o){K(r,e,o)},p:$,d(r){r&&p(e)}}}function pe(a){let e,t,r;return{c(){e=se("svg"),t=se("path"),this.h()},l(o){e=te(o,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var c=x(e);t=te(c,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(t).forEach(p),c.forEach(p),this.h()},h(){s(t,"stroke-linecap","round"),s(t,"stroke-linejoin","round"),s(t,"stroke-width","2"),s(t,"d","M19 9l-7 7-7-7"),s(e,"class",r="w-4 h-4 text-slate-600 transform transition-transform "+(a[15]?"rotate-180":"")),s(e,"fill","none"),s(e,"stroke","currentColor"),s(e,"viewBox","0 0 24 24")},m(o,c){K(o,e,c),l(e,t)},p(o,c){c&40&&r!==(r="w-4 h-4 text-slate-600 transform transition-transform "+(o[15]?"rotate-180":""))&&s(e,"class",r)},d(o){o&&p(e)}}}function ve(a){let e,t,r="Detalles Técnicos",o,c,_=a[14].details+"",y,u,f,n,m,E="Usuario ID",V,L,M=(a[14].userId||"N/A")+"",i,C,D,I,U="User Agent",N,S,j=(a[14].userAgent||"N/A")+"",P,R,q,T;return{c(){e=w("div"),t=w("div"),t.textContent=r,o=A(),c=w("pre"),y=J(_),u=A(),f=w("div"),n=w("div"),m=w("span"),m.textContent=E,V=A(),L=w("span"),i=J(M),C=A(),D=w("div"),I=w("span"),I.textContent=U,N=A(),S=w("span"),P=J(j),this.h()},l(g){e=b(g,"DIV",{class:!0});var v=x(e);t=b(v,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-1j3qeuq"&&(t.textContent=r),o=B(v),c=b(v,"PRE",{class:!0});var z=x(c);y=G(z,_),z.forEach(p),u=B(v),f=b(v,"DIV",{class:!0});var d=x(f);n=b(d,"DIV",{});var h=x(n);m=b(h,"SPAN",{class:!0,"data-svelte-h":!0}),Y(m)!=="svelte-1h4ae54"&&(m.textContent=E),V=B(h),L=b(h,"SPAN",{class:!0});var k=x(L);i=G(k,M),k.forEach(p),h.forEach(p),C=B(d),D=b(d,"DIV",{});var H=x(D);I=b(H,"SPAN",{class:!0,"data-svelte-h":!0}),Y(I)!=="svelte-rqfrz7"&&(I.textContent=U),N=B(H),S=b(H,"SPAN",{class:!0,title:!0});var O=x(S);P=G(O,j),O.forEach(p),H.forEach(p),d.forEach(p),v.forEach(p),this.h()},h(){s(t,"class","text-[10px] text-slate-500 mb-2 uppercase tracking-wide"),s(c,"class","text-xs text-indigo-300 font-mono whitespace-pre-wrap max-h-60 overflow-y-auto custom-scrollbar svelte-vpf7wd"),s(m,"class","text-slate-500 block"),s(L,"class","text-slate-300 font-mono"),s(I,"class","text-slate-500 block"),s(S,"class","text-slate-300 font-mono truncate block"),s(S,"title",R=a[14].userAgent),s(f,"class","mt-3 pt-3 border-t border-white/5 grid grid-cols-2 gap-4 text-xs"),s(e,"class","mt-4 bg-black/40 rounded-lg p-4 border border-white/5 overflow-x-auto")},m(g,v){K(g,e,v),l(e,t),l(e,o),l(e,c),l(c,y),l(e,u),l(e,f),l(f,n),l(n,m),l(n,V),l(n,L),l(L,i),l(f,C),l(f,D),l(D,I),l(D,N),l(D,S),l(S,P),T=!0},p(g,v){(!T||v&8)&&_!==(_=g[14].details+"")&&X(y,_),(!T||v&8)&&M!==(M=(g[14].userId||"N/A")+"")&&X(i,M),(!T||v&8)&&j!==(j=(g[14].userAgent||"N/A")+"")&&X(P,j),(!T||v&8&&R!==(R=g[14].userAgent))&&s(S,"title",R)},i(g){T||(g&&Ce(()=>{T&&(q||(q=de(e,ce,{duration:200},!0)),q.run(1))}),T=!0)},o(g){g&&(q||(q=de(e,ce,{duration:200},!1)),q.run(0)),T=!1},d(g){g&&p(e),g&&q&&q.end()}}}function me(a,e){let t,r,o,c,_=_e(e[14].level)+"",y,u=e[14].level+"",f,n,m,E,V=be(e[14].timestamp)+"",L,M,i,C,D,I=e[14].message+"",U,N,S,j,P,R,q,T,g=e[14].details&&pe(e),v=e[15]&&e[14].details&&ve(e);function z(){return e[11](e[14])}return{key:a,first:null,c(){t=w("tr"),r=w("td"),o=w("div"),c=new De(!1),y=A(),f=J(u),m=A(),E=w("td"),L=J(V),M=A(),i=w("td"),C=w("div"),D=w("span"),U=J(I),S=A(),g&&g.c(),j=A(),v&&v.c(),P=A(),this.h()},l(d){t=b(d,"TR",{class:!0});var h=x(t);r=b(h,"TD",{class:!0});var k=x(r);o=b(k,"DIV",{class:!0});var H=x(o);c=Ee(H,!1),y=B(H),f=G(H,u),H.forEach(p),k.forEach(p),m=B(h),E=b(h,"TD",{class:!0});var O=x(E);L=G(O,V),O.forEach(p),M=B(h),i=b(h,"TD",{class:!0});var F=x(i);C=b(F,"DIV",{class:!0});var Q=x(C);D=b(Q,"SPAN",{class:!0});var W=x(D);U=G(W,I),W.forEach(p),S=B(Q),g&&g.l(Q),Q.forEach(p),j=B(F),v&&v.l(F),F.forEach(p),P=B(h),h.forEach(p),this.h()},h(){c.a=y,s(o,"class",n="flex items-center gap-2 "+ge(e[14].level)+" px-2 py-1 rounded w-fit border text-[10px] font-bold uppercase tracking-wider svelte-vpf7wd"),s(r,"class","py-3 px-6 whitespace-nowrap align-top"),s(E,"class","py-4 px-6 whitespace-nowrap text-slate-500 align-top text-xs"),s(D,"class",N="break-all "+(e[14].level==="error"?"text-rose-200":"")),s(C,"class","flex items-start justify-between gap-4"),s(i,"class","py-4 px-6 text-slate-300 align-top"),s(t,"class",R="hover:bg-white/[0.02] transition-colors cursor-pointer group "+(e[15]?"bg-white/[0.02]":"")),this.first=t},m(d,h){K(d,t,h),l(t,r),l(r,o),c.m(_,o),l(o,y),l(o,f),l(t,m),l(t,E),l(E,L),l(t,M),l(t,i),l(i,C),l(C,D),l(D,U),l(C,S),g&&g.m(C,null),l(i,j),v&&v.m(i,null),l(t,P),q||(T=ee(t,"click",z),q=!0)},p(d,h){e=d,h&8&&_!==(_=_e(e[14].level)+"")&&c.p(_),h&8&&u!==(u=e[14].level+"")&&X(f,u),h&8&&n!==(n="flex items-center gap-2 "+ge(e[14].level)+" px-2 py-1 rounded w-fit border text-[10px] font-bold uppercase tracking-wider svelte-vpf7wd")&&s(o,"class",n),h&8&&V!==(V=be(e[14].timestamp)+"")&&X(L,V),h&8&&I!==(I=e[14].message+"")&&X(U,I),h&8&&N!==(N="break-all "+(e[14].level==="error"?"text-rose-200":""))&&s(D,"class",N),e[14].details?g?g.p(e,h):(g=pe(e),g.c(),g.m(C,null)):g&&(g.d(1),g=null),e[15]&&e[14].details?v?(v.p(e,h),h&40&&ie(v,1)):(v=ve(e),v.c(),ie(v,1),v.m(i,null)):v&&(Le(),Me(v,1,1,()=>{v=null}),Ve()),h&40&&R!==(R="hover:bg-white/[0.02] transition-colors cursor-pointer group "+(e[15]?"bg-white/[0.02]":""))&&s(t,"class",R)},d(d){d&&p(t),g&&g.d(),v&&v.d(),q=!1,T()}}}function Ye(a){let e,t,r,o,c=`<h1 class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-white via-indigo-200 to-indigo-400 tracking-tight mb-2">System Logs</h1> <p class="text-slate-400 font-mono text-sm flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    Sistema en línea • Monitoreo activo</p>`,_,y,u,f,n,m,E,V,L,M,i,C='<svg class="h-4 w-4 text-slate-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',D,I,U,N,S,j,P,R,q=le(["all","error","warn","info"]),T=[];for(let d=0;d<4;d+=1)T[d]=he(fe(a,q,d));function g(d,h){return d[4]&&d[0].length===0?Fe:d[3].length===0?Oe:Ue}let v=g(a),z=v(a);return{c(){e=w("div"),t=w("div"),r=w("div"),o=w("div"),o.innerHTML=c,_=A(),y=w("div"),u=w("button"),f=se("svg"),n=se("path"),E=J(`\r
                    Refresh`),V=A(),L=w("div"),M=w("div"),i=w("div"),i.innerHTML=C,D=A(),I=w("input"),U=A(),N=w("div");for(let d=0;d<4;d+=1)T[d].c();S=A(),j=w("div"),z.c(),this.h()},l(d){e=b(d,"DIV",{class:!0});var h=x(e);t=b(h,"DIV",{class:!0});var k=x(t);r=b(k,"DIV",{class:!0});var H=x(r);o=b(H,"DIV",{"data-svelte-h":!0}),Y(o)!=="svelte-1iekirx"&&(o.innerHTML=c),_=B(H),y=b(H,"DIV",{class:!0});var O=x(y);u=b(O,"BUTTON",{class:!0});var F=x(u);f=te(F,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0});var Q=x(f);n=te(Q,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),x(n).forEach(p),Q.forEach(p),E=G(F,`\r
                    Refresh`),F.forEach(p),O.forEach(p),H.forEach(p),V=B(k),L=b(k,"DIV",{class:!0});var W=x(L);M=b(W,"DIV",{class:!0});var Z=x(M);i=b(Z,"DIV",{class:!0,"data-svelte-h":!0}),Y(i)!=="svelte-1xncy8t"&&(i.innerHTML=C),D=B(Z),I=b(Z,"INPUT",{type:!0,placeholder:!0,class:!0}),Z.forEach(p),U=B(W),N=b(W,"DIV",{class:!0});var ae=x(N);for(let re=0;re<4;re+=1)T[re].l(ae);ae.forEach(p),W.forEach(p),S=B(k),j=b(k,"DIV",{class:!0});var oe=x(j);z.l(oe),oe.forEach(p),k.forEach(p),h.forEach(p),this.h()},h(){s(n,"stroke-linecap","round"),s(n,"stroke-linejoin","round"),s(n,"stroke-width","2"),s(n,"d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"),s(f,"class",m="w-4 h-4 "+(a[4]?"animate-spin":"")),s(f,"fill","none"),s(f,"stroke","currentColor"),s(f,"viewBox","0 0 24 24"),s(u,"class","px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg transition-all text-sm font-medium flex items-center gap-2 active:scale-95"),u.disabled=a[4],s(y,"class","flex gap-3"),s(r,"class","flex flex-col md:flex-row md:items-end justify-between gap-6 mb-10"),s(i,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),s(I,"type","text"),s(I,"placeholder","Buscar en logs..."),s(I,"class","block w-full pl-10 pr-3 py-2.5 border border-white/10 rounded-xl leading-5 bg-black/20 text-slate-300 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-indigo-500/50 sm:text-sm transition-all"),s(M,"class","relative flex-1"),s(N,"class","flex p-1 bg-black/20 rounded-xl border border-white/5"),s(L,"class","bg-[#131B2D] border border-white/5 rounded-2xl p-4 mb-8 flex flex-col md:flex-row gap-4 shadow-xl"),s(j,"class","bg-[#0f1623] border border-white/5 rounded-2xl overflow-hidden shadow-2xl relative min-h-[400px]"),s(t,"class","max-w-7xl mx-auto"),s(e,"class","min-h-screen bg-[#0B1120] text-slate-300 font-sans p-6 md:p-12 pb-24")},m(d,h){K(d,e,h),l(e,t),l(t,r),l(r,o),l(r,_),l(r,y),l(y,u),l(u,f),l(f,n),l(u,E),l(t,V),l(t,L),l(L,M),l(M,i),l(M,D),l(M,I),ne(I,a[2]),l(L,U),l(L,N);for(let k=0;k<4;k+=1)T[k]&&T[k].m(N,null);l(t,S),l(t,j),z.m(j,null),P||(R=[ee(u,"click",a[6]),ee(I,"input",a[9])],P=!0)},p(d,[h]){if(h&16&&m!==(m="w-4 h-4 "+(d[4]?"animate-spin":""))&&s(f,"class",m),h&16&&(u.disabled=d[4]),h&4&&I.value!==d[2]&&ne(I,d[2]),h&258){q=le(["all","error","warn","info"]);let k;for(k=0;k<4;k+=1){const H=fe(d,q,k);T[k]?T[k].p(H,h):(T[k]=he(H),T[k].c(),T[k].m(N,null))}for(;k<4;k+=1)T[k].d(1)}v===(v=g(d))&&z?z.p(d,h):(z.d(1),z=v(d),z&&(z.c(),z.m(j,null)))},i:$,o:$,d(d){d&&p(e),ke(T,d),z.d(),P=!1,xe(R)}}}function _e(a){switch(a){case"error":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>';case"warn":return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>';default:return'<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>'}}function ge(a){switch(a){case"error":return"text-rose-400 bg-rose-500/10 border-rose-500/20 shadow-[0_0_10px_rgba(251,113,133,0.2)]";case"warn":return"text-amber-400 bg-amber-500/10 border-amber-500/20 shadow-[0_0_10px_rgba(251,191,36,0.2)]";default:return"text-blue-400 bg-blue-500/10 border-blue-500/20 shadow-[0_0_10px_rgba(96,165,250,0.2)]"}}function be(a){return a?new Intl.DateTimeFormat("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit",day:"2-digit",month:"short"}).format(a):"-"}function Ge(a,e,t){let r=[],o=[],c=!0,_="all",y="",u=new Set;ye(()=>je.subscribe(async C=>{if(!C.loading){if(!C.profile?.isAdmin){He("/");return}await f(),t(4,c=!1)}}));async function f(){try{t(4,c=!0);const i=Ne(Se(qe,"system_logs"),ze("timestamp","desc"),Pe(100)),C=await Re(i);t(0,r=C.docs.map(D=>({id:D.id,...D.data(),timestamp:D.data().timestamp?.toDate()}))),n()}catch(i){console.error("Error loading logs:",i),i.message}finally{t(4,c=!1)}}function n(){let i=[...r];if(_!=="all"&&(i=i.filter(C=>C.level===_)),y){const C=y.toLowerCase();i=i.filter(D=>D.message.toLowerCase().includes(C)||D.details&&D.details.toLowerCase().includes(C))}t(3,o=i)}function m(i){u.has(i)?u.delete(i):u.add(i),t(5,u)}function E(i){t(1,_=i)}function V(){y=this.value,t(2,y)}const L=i=>E(i),M=i=>m(i.id);return a.$$.update=()=>{a.$$.dirty&7&&r.length&&n()},[r,_,y,o,c,u,f,m,E,V,L,M]}class et extends Te{constructor(e){super(),Ie(this,e,Ge,Ye,we,{})}}export{et as component};
