import{w as f}from"./E95olI4G.js";import{u as b}from"./CZVmiJFr.js";import{a as y,d as g,i as D,s as P,u as A}from"./DtVK9R3Z.js";const x={free:{id:"free",name:"Free",price:"Gratis",priceValue:0,billing:"Para siempre",features:["2 Ã¡lbumes bÃ¡sicos","Audio estÃ¡ndar (128kbps)","Tablero clÃ¡sico","Acceso al ambiente bÃ¡sico"],maxGamesDaily:0,canAccessPremiumVibes:!1},pro:{id:"pro",name:"Pro",price:"â‚¬19.99",priceValue:19.99,billing:"anual",features:["âœ¨ Todos los Ã¡lbumes ilimitados","âŒ Sin anuncios","ðŸŽµ Audio de alta calidad","ðŸŽ¨ Tableros personalizables (prÃ³ximamente)","ðŸŒ§ï¸ Fondos animados premium (prÃ³ximamente)","ðŸ“¥ Descargas offline (prÃ³ximamente)","ðŸŽ¯ Acceso anticipado (prÃ³ximamente)","ðŸ‘‘ Badge exclusivo (prÃ³ximamente)","ðŸ—³ï¸ Vota en la Roadmap (prÃ³ximamente)"],maxGamesDaily:1/0,canAccessPremiumVibes:!0},premium:{id:"premium",name:"Premium",price:"â‚¬19.99",priceValue:19.99,billing:"anual",features:["âœ¨ Todos los Ã¡lbumes ilimitados","ðŸŽµ Audio HD (320kbps)","ðŸŽ¨ Tableros personalizables","ðŸŒ§ï¸ Fondos animados premium","ðŸ“¥ Descargas offline (prÃ³ximamente)","ðŸŽ¯ Acceso anticipado a nuevos Ã¡lbumes","âŒ Sin anuncios","ðŸ‘‘ Badge exclusivo","ðŸ—³ï¸ Vota en la Roadmap"],maxGamesDaily:1/0,canAccessPremiumVibes:!0}};function u(t,i){const e=["none","asap-forever"];return t==="free"?e.includes(i):!0}function d(t,i){const e=x[t].maxGamesDaily;if(e===1/0)return{canPlay:!0,remaining:1/0};const a=Math.max(0,e-i);return{canPlay:a>0,remaining:a}}const m={profile:null,loading:!0,tier:"free",canAccessVibe:()=>!1,canPlayGame:()=>!1};function T(){const{subscribe:t,set:i}=f(m);let e=null;return b.subscribe(a=>{if(e&&(e(),e=null),!a.user){i(m);return}const o=y(g,"users",a.user.uid);e=D(o,async r=>{if(!r.exists()){const n={uid:a.user.uid,email:a.user.email||"",displayName:a.user.displayName||"Usuario",photoURL:a.user.photoURL||"",subscriptionTier:"free",subscriptionStatus:"active",gamesPlayedToday:0,lastGamePlayed:Date.now(),lastResetDate:new Date().toISOString().split("T")[0],createdAt:Date.now(),updatedAt:Date.now()};await P(o,n),i({profile:n,loading:!1,tier:"free",canAccessVibe:p=>u("free",p),canPlayGame:()=>d("free",0).canPlay});return}const s=r.data(),l=s.subscriptionTier||"free",c=new Date().toISOString().split("T")[0];s.lastResetDate!==c&&(await A(o,{gamesPlayedToday:0,lastResetDate:c,updatedAt:Date.now()}),s.gamesPlayedToday=0,s.lastResetDate=c),i({profile:s,loading:!1,tier:l,canAccessVibe:n=>u(l,n),canPlayGame:()=>d(l,s.gamesPlayedToday).canPlay})},r=>{console.error("Error listening to user profile:",r),i({...m,loading:!1})})}),{subscribe:t}}const G=T();export{x as T,G as u};
